var view={variables:{item:document.getElementById("variables"),show:function(){var e="<table>";for(var t in e+="<tr><td><b>length</b></td><td>"+model.length()+"</td><td>&#60;"+typeof model.length()+"&#62;</td></tr>",model.variables)e+="<tr><td><b>"+t+"</b></td><td>"+model.variables[t]+"</td><td>&#60;"+typeof model.variables[t]+"&#62;</td></tr>";e+="</table>",view.variables.item.innerHTML=e}},display:{item:document.getElementById("display"),show:function(e){view.display.item.value=e}},history:{item:document.getElementById("history"),show:function(){view.history.item.innerHTML=model.variables.history},clear:function(){view.history.item.innerHTML=""}},status:{item:document.getElementById("status"),show:function(e){view.status.item.innerHTML=e},clear:function(){view.status.item.innerHTML=""}},numbers:{n1:document.getElementById("n1"),n2:document.getElementById("n2"),n3:document.getElementById("n3"),n4:document.getElementById("n4"),n5:document.getElementById("n5"),n6:document.getElementById("n6"),n7:document.getElementById("n7"),n8:document.getElementById("n8"),n9:document.getElementById("n9"),n0:document.getElementById("n0"),inv:document.getElementById("inv"),dot:document.getElementById("dot")},arithmetic:{division:document.getElementById("div"),multiplication:document.getElementById("mul"),subtraction:document.getElementById("minus"),addition:document.getElementById("plus")},control:{delete:document.getElementById("del"),pop:document.getElementById("ce"),clear:document.getElementById("c"),equally:document.getElementById("equally")}},model={variables:{current:0,memory:0,result:0,limit:14,operation:"",history:"",firstStep:!0},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},reset:function(){model.variables={current:0,memory:0,result:0,limit:14,operation:"",history:"",firstStep:!0},view.history.clear(),model.resetCurrent()},resetCurrent:function(){model.variables.current=0,view.status.clear(),view.display.show(model.variables.current),view.variables.show()},length:function(){return(model.variables.current+"").replace(".","").replace("-","").length},push:function(e){model.length()<model.variables.limit?(model.variables.current=0===model.variables.current||"0"==model.variables.current?e:model.variables.current+""+e,view.display.show(model.variables.current),view.status.clear()):view.status.show("Ограничение колличества знаков"),view.variables.show()},inversion:function(){0!=model.variables.current||"0"!=model.variables.current?("number"==typeof model.variables.current?model.variables.current*=-1:"string"==typeof model.variables.current&&("-"==model.variables.current[0]?model.variables.current=model.variables.current.slice(1):model.variables.current="-"+model.variables.current),view.display.show(model.variables.current),view.status.clear()):view.status.show("Нулю не может быть присвоен никакой знак"),view.variables.show()},decimal:function(){-1==(model.variables.current+"").indexOf(".")?(model.variables.current+=".",view.display.show(model.variables.current),view.status.clear()):view.status.show("Число уже имеет десятичный знак"),view.variables.show()},delete:function(){if(0!=model.variables.current||"0"!=model.variables.current){var e=(model.variables.current+"").slice(0,model.variables.current.length-1);isNaN(e)||""==e?model.variables.current=0:model.variables.current=e,view.display.show(model.variables.current),view.status.clear()}else view.status.show("Очистка завершена");view.variables.show()},log:{add:function(e){model.variables.current<0?model.variables.history+="("+model.variables.current+") "+e+" ":model.variables.history+=model.variables.current+" "+e+" "},delete:function(e){var t=model.variables.history.slice(0,model.variables.history.length-2);model.variables.history=t+e+" "},finish:function(){var e=model.variables.history.slice(0,model.variables.history.length-2);model.variables.history=e+" = <b>"+model.variables.result+"</b>"},clear:function(){model.variables.history=""}},equally:function(){model.calculator.firstStep=!0,"equally"!=model.calculator.operation&&(model.history.add(""),"addition"==model.calculator.operation?model.calculator.result+=model.calculator.current:"subtraction"==model.calculator.operation&&(model.calculator.result-=model.calculator.current),model.calculator.memory=0,model.calculator.current=model.calculator.result,model.history.finish(),view.display.refresh(),view.history.show(),model.history.clear(),model.calculator.operation="equally")},arithmetic:{addition:function(){model.variables.firstStep?(model.log.add("+"),view.history.show(),model.variables.memory=+model.variables.current,model.variables.current=0):"addition"==model.variables.operation&&0!==model.variables.current?(model.log.add("+"),view.history.show(),model.variables.memory+=+model.variables.current,model.variables.current=0):(model.log.delete("+"),0!=model.variables.current&&(model.log.add("+"),model.variables.memory+=+model.variables.current,model.variables.current=0),view.history.show()),model.variables.operation="addition",model.variables.firstStep=!1,view.display.show(model.variables.memory),view.status.clear(),view.variables.show()},subtraction:function(){model.variables.firstStep?(model.log.add("-"),view.history.show(),model.variables.memory=model.variables.current,model.variables.current=0):"subtraction"==model.variables.operation&&0!==model.variables.current?(model.log.add("-"),view.history.show(),model.variables.memory-=model.variables.current,model.variables.current=0):(model.log.delete("-"),0!=model.variables.current&&(model.log.add("-"),model.variables.memory-=model.variables.current,model.variables.current=0),view.history.show()),model.variables.operation="subtraction",model.variables.firstStep=!1,view.display.show(model.variables.memory),view.status.clear(),view.variables.show()},division:function(){console.log("division")},multiplication:function(){console.log("multiplication")}}},controller={numbers:{push:function(e){var t=e.target.innerHTML;model.push(t)},inversion:function(){model.inversion()},decimal:function(){model.decimal()}},control:{delete:function(){model.delete()},pop:function(){model.resetCurrent()},clear:function(){model.reset()},equally:function(){model.equally()}},arithmetic:{division:function(){model.arithmetic.division()},multiplication:function(){model.arithmetic.multiplication()},subtraction:function(){model.arithmetic.subtraction()},addition:function(){model.arithmetic.addition()}}};({init:function(){model.reset(),this.event()},event:function(){view.numbers.n1.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n2.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n3.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n4.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n5.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n6.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n7.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n8.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n9.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n0.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.inv.addEventListener("click",controller.numbers.inversion),view.numbers.dot.addEventListener("click",controller.numbers.decimal),view.arithmetic.division.addEventListener("click",controller.arithmetic.division),view.arithmetic.multiplication.addEventListener("click",controller.arithmetic.multiplication),view.arithmetic.subtraction.addEventListener("click",controller.arithmetic.subtraction),view.arithmetic.addition.addEventListener("click",controller.arithmetic.addition),view.control.delete.addEventListener("click",controller.control.delete),view.control.pop.addEventListener("click",controller.control.pop),view.control.clear.addEventListener("click",controller.control.clear),view.control.equally.addEventListener("click",controller.control.equally)}}).init();