var view={display:{item:document.getElementById("display"),show:function(e){view.display.item.value=e}},history:{item:document.getElementById("history"),show:function(){view.history.item.innerHTML=model.calculator.history},clear:function(){view.history.item.innerHTML=""}},status:{item:document.getElementById("status"),show:function(e){view.status.item.innerHTML=e},clear:function(){view.status.item.innerHTML=""}},numbers:{n1:document.getElementById("n1"),n2:document.getElementById("n2"),n3:document.getElementById("n3"),n4:document.getElementById("n4"),n5:document.getElementById("n5"),n6:document.getElementById("n6"),n7:document.getElementById("n7"),n8:document.getElementById("n8"),n9:document.getElementById("n9"),n0:document.getElementById("n0"),inv:document.getElementById("inv"),dot:document.getElementById("dot")},arithmetic:{division:document.getElementById("div"),multiplication:document.getElementById("mul"),subtraction:document.getElementById("minus"),addition:document.getElementById("plus")},control:{delete:document.getElementById("del"),pop:document.getElementById("ce"),clear:document.getElementById("c"),equally:document.getElementById("equally")}},model={current:0,memomy:0,result:0,limit:15,operation:"",history:"",firstStep:!0,isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},reset:function(){model.current=0,model.memory=0,model.result=0,model.operation="",model.firstStep=!0,view.display.show(model.current),view.status.clear(),model.log.clear(),view.history.clear()},resetCurrent:function(){model.current=0,view.display.show(model.current),view.status.clear()},length:function(){return(model.current+"").length},push:function(e){model.length()<model.limit?(0===model.current?model.current=e:model.current=model.current+""+e,view.display.show(model.current),view.status.clear()):view.status.show("Ограничение колличества знаков")},delete:function(){if(0!=model.current||"0"!=model.current){var e=(model.current+"").slice(0,model.length()-1);isNaN(e)||""==e?model.current=0:model.current=e,view.display.show(model.current),view.status.clear()}else view.status.show("Очистка завершена")},inversion:function(){0!=model.current||"0"!=model.current?("number"==typeof model.current?model.current*=-1:"string"==typeof model.current&&("-"==model.current[0]?model.current=model.current.slice(1):model.current="-"+model.current),view.display.show(model.current),view.status.clear()):view.status.show("Нулю не может быть присвоен никакой знак")},decimal:function(){-1==(model.current+"").indexOf(".")?(model.current+=".",view.display.show(model.current),view.status.clear()):view.status.show("Число уже имеет десятичный знак")},log:{add:function(e){model.current<0?model.history+="("+model.current+") "+e+" ":model.history+=model.current+" "+e+" "},edit:function(e){var t=model.history.slice(0,model.history.length-2);model.history=t+e+" "},finish:function(){var e=model.history.slice(0,model.history.length-2);model.history=e+" = <b>"+model.result+"</b>"},clear:function(){model.history=""}},equally:function(){model.calculator.firstStep=!0,"equally"!=model.calculator.operation&&(model.history.add(""),"addition"==model.calculator.operation?model.calculator.result+=model.calculator.current:"subtraction"==model.calculator.operation&&(model.calculator.result-=model.calculator.current),model.calculator.memomy=0,model.calculator.current=model.calculator.result,model.history.finish(),view.display.refresh(),view.history.show(),model.history.clear(),model.calculator.operation="equally")},arithmetic:{division:function(){console.log("division")},multiplication:function(){console.log("multiplication")},subtraction:function(){console.log("----Вычитание--------------------------------"),console.log(model.calculator.firstStep,model.calculator.current,model.calculator.memomy,model.calculator.result),model.calculator.firstStep?(model.history.add("-"),view.history.show(),model.calculator.memomy=model.calculator.current,model.calculator.current=0):"subtraction"==model.calculator.operation?(model.history.add("-"),view.history.show(),model.calculator.memomy-=model.calculator.current,model.calculator.current=0):(console.log("Другая операция"),model.history.edit("-"),0!=model.calculator.current&&(model.history.add("-"),model.calculator.memomy-=model.calculator.current,model.calculator.current=0),view.history.show()),model.calculator.operation="subtraction",model.calculator.firstStep=!1,view.display.refresh(),view.status.clear(),console.log(model.calculator.firstStep,model.calculator.current,model.calculator.memomy,model.calculator.result),console.log("---------------------------------------------")},addition:function(){console.log("----Сложение---------------------------------"),console.log(model.calculator.firstStep,model.calculator.current,model.calculator.memomy,model.calculator.result),model.calculator.firstStep?(model.history.add("+"),view.history.show(),model.calculator.memomy=model.calculator.current,model.calculator.current=0):"addition"==model.calculator.operation?(model.history.add("+"),view.history.show(),model.calculator.memomy+=model.calculator.current,model.calculator.current=0):(console.log("Другая операция"),model.history.edit("+"),0!=model.calculator.current&&(model.history.add("+"),model.calculator.memomy+=model.calculator.current,model.calculator.current=0),view.history.show()),model.calculator.operation="addition",model.calculator.firstStep=!1,view.display.memory(),view.status.clear(),console.log(model.calculator.firstStep,model.calculator.current,model.calculator.memomy,model.calculator.result),console.log("---------------------------------------------")}}},controller={numbers:{push:function(e){var t=e.target.innerHTML;model.push(t)},inversion:function(){model.inversion()},decimal:function(){model.decimal()}},control:{delete:function(){model.delete()},pop:function(){model.resetCurrent()},clear:function(){model.reset()},equally:function(){model.equally()}},arithmetic:{division:function(){model.arithmetic.division()},multiplication:function(){model.arithmetic.multiplication()},subtraction:function(){model.arithmetic.subtraction()},addition:function(){model.arithmetic.addition()}}};({init:function(){model.reset(),this.event()},event:function(){view.numbers.n1.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n2.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n3.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n4.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n5.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n6.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n7.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n8.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n9.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.n0.addEventListener("click",function(e){controller.numbers.push(e)}),view.numbers.inv.addEventListener("click",controller.numbers.inversion),view.numbers.dot.addEventListener("click",controller.numbers.decimal),view.arithmetic.division.addEventListener("click",controller.arithmetic.division),view.arithmetic.multiplication.addEventListener("click",controller.arithmetic.multiplication),view.arithmetic.subtraction.addEventListener("click",controller.arithmetic.subtraction),view.arithmetic.addition.addEventListener("click",controller.arithmetic.addition),view.control.delete.addEventListener("click",controller.control.delete),view.control.pop.addEventListener("click",controller.control.pop),view.control.clear.addEventListener("click",controller.control.clear),view.control.equally.addEventListener("click",controller.control.equally)}}).init();